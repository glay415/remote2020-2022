## 자바 직렬화

----

### 개요

- JVM의 메모리에 상주(힙 또는 스택)되어 있는 객체 데이터를 받이트 형태로 변환하는 기술과 직렬화된 바이트 형태의 데이터를 객체로 변환해서 JVM으로 상주시키는 형태

### 직렬화(Serialization)

- 객체를 직렬화하여 자바 시스템 내부에서 사용되는 객체 또는 데이터들을 외부의 자바 시스템에서도 사용할 수 있도록 바이트 형태로 변환하는 기술
- 객체들의 데이터를 연속적인(serial) 데이터로 변형하여 Stream을 통해 데이터를 읽도록 해준다.

```java
public class User implements Serializable {
    private Stirng id;
    private String password;
    private transient String email;
    
    private Item item;
}

class Item implements Serializable {   
}
```

- primitive 타입과 java.io.Serializable 인터페이스를 구현하는 객체는 직렬화 할 수 있는 기본 조건을 가진다.
  - Serializable 인터페이스를 구현하는 객체를 상속받을 경우에도 가능하다.
- transient를 이용하여 특정 멤버변수를 직렬화 대상에서 제외 시킬 수 있다.
- 다른 객체를 멤버변수로 가지고 있는 경우 그 멤버변수들 중 Serializable 인터페이스를 구현하지 않은 클래스가 하나라도 있다면 직렬화할 수 없다.

### 역직렬화(Deserialization)

- 직렬화된 파일 등을 역으로 직렬화하여 다시 객체의 형태로 만드는 것
- 저장된 파일을 읽거나 전송된 스트림 데이터를 읽어 원래 객체의 형태로 복원한다.

### 자바 직렬화의 장점

- 자바 시스템의 개발에 최적화 되어있고, 복잡한 데이터 구조의 클래스 객체일지라도, 직렬화의 기본만 지키면 큰 작업 없이 직렬화/역직렬화가 가능하다.
- 데이터 타입이 자동으로 맞춰지기 떄문에 관련 부분을 크게 신경쓰지 않아도 된다.

### 자바 직렬화의 사용처

- JVM의 메모리에만 상주되어 있는 객체를 그대로 영속화가 필요할때 사용된다.
  - 시스템이 종료되더라도 없어지지 않고, 영속화된 데이터이기 때문에 네트워크로 전송이 가능
- Servlet Session
  - Servlet 기반 WAS들은 대부분 세션의 자바 직렬화를 지원하며 파일로 저장하거나 세션 클러스트링, DB 저장 옵션등을 선택하면 세션 자체가 직렬화 되어 전달된다.
- Cache
  - 캐시를 적용할때 자바직렬화를 이용하는 것이 가장 간편하다.
- RMI
  - 원격 시스템의 메서드를 호출할 때 전달하는 메세지를 자동으로 직렬화하여 사용하고, 전달받은 원격 시스템에서 해당 메세지를 역직렬화하여 사용한다.
- 객체가 세션에 저장하지 않는 단순한 데이터 집합이거나 컨트롤러에서 생성되어 뷰에서 소멸하는 데이터의 전달체라면 객체 직렬화는 고려하지 않아도 된다.

### JSON  직렬화

- 지금까지는 객체 직렬화를 JVM과 ObjectInputStream/ObjectOutputStream에 위임하는 방식이었지만 XML, JSON과 같은 포맷을 이용한 직렬화도 가능하다.
- 포맷을 이용한 직렬화의 장점은 다른 환경, 다른 언어로 만들어진 어플리케이션과도 통신이 가능해진다는 것이다.
- Jackson과 같은 JSON 파싱, 처리 라이브러리를 사용하여 자바 객체를 JSON으로 직렬화하거나 JSON 데이터를 자바 객체로 역직렬화할 수 있다.

---

